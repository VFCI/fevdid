<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fevdid">
<title>Derivations for Max Share Identification Method • fevdid</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Derivations for Max Share Identification Method">
<meta property="og:description" content="fevdid">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fevdid</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/derivations.html">Derivations for Max Share Identification Method</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Derivations for Max Share Identification Method</h1>
                        <h4 data-toc-skip class="author">Matthew
DeHaven</h4>
            
            <h4 data-toc-skip class="date">January 16, 2023</h4>
      
      
      <div class="d-none name"><code>derivations.Rmd</code></div>
    </div>

    
    
<p>Article explaining the mathematics behind the two key
<code>fevdid</code> functions:</p>
<ul>
<li><code><a href="../reference/id_fevdfd.html">id_fevdfd()</a></code></li>
<li><code><a href="../reference/id_fevdtd.html">id_fevdtd()</a></code></li>
</ul>
<div class="section level3">
<h3 id="structural-vector-autoregression-svar">Structural Vector Autoregression (SVAR)<a class="anchor" aria-label="anchor" href="#structural-vector-autoregression-svar"></a>
</h3>
<p>A SVAR(p) model with <span class="math inline">\(p\)</span> lags, for
a vector of variables <span class="math inline">\(y_t\)</span>, assumes
the data generating process is accurately represented as, <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Notation and setup follows Chapter 1: Introduction from
Kilian and Lutkepohl (2017)&lt;/p&gt;"><sup>1</sup></a></p>
<p><span class="math display">\[
B_0 y_t = B_1 y_{t-1} + ... + B_p y_{t-p} + w_t
\]</span></p>
<p>where <span class="math inline">\(w_t\)</span> are mean zero
structural shocks, with a serially uncorrelated diagonal covariance
matrix of <span class="math inline">\(\Sigma_w = E[w_t
w_t]\)</span>,</p>
<p>and <span class="math inline">\(B_i\)</span> are matrices of
coefficients.</p>
<p>Empirically, however, only the following <span class="math inline">\(A_i\)</span> matrices of coefficients and <span class="math inline">\(v_t\)</span> vector of reduced form residuals are
observed,</p>
<p><span class="math display">\[
y_t = \underbrace{B_0^{-1}B_1}_{A_1} y_{t-1} + ... +
\underbrace{B_0^{-1}B_p}_{A_p} y_{t-p} + \underbrace{B_0^{-1} w_t}_{u_t}
\\
y_t = A_1 y_{t-1} + ... + A_p y_{t-p} + u_t
\]</span></p>
<div class="section level5">
<h5 id="identification-problem">Identification Problem<a class="anchor" aria-label="anchor" href="#identification-problem"></a>
</h5>
<p>We observe reduced form residuals, <span class="math inline">\(v_t\)</span>, but want the structural shocks,
<span class="math inline">\(w_t\)</span>.</p>
<p><span class="math display">\[
u_t = B_0^{-1} w_t
\]</span></p>
<p>At this point, WLOG, assume that <span class="math inline">\(\Sigma_w
= I\)</span>.</p>
<p>This implies that <span class="math inline">\(\Sigma_u = B_0^{-1}
B_0^{-1^\prime}\)</span>.</p>
<p>In order to identify the structural shocks, we simply need to know
the structural impact matrix, <span class="math inline">\(B_0\)</span>,
or equivalently, the inverse <span class="math inline">\(B_0^{-1}\)</span>.</p>
</div>
<div class="section level4">
<h4 id="impulse-response-functions-irf-and-forecast-errors">Impulse Response Functions (IRF) and Forecast Errors<a class="anchor" aria-label="anchor" href="#impulse-response-functions-irf-and-forecast-errors"></a>
</h4>
<p>It will be useful for the max share method to show the impulse
response and forecast error definitions</p>
<div class="section level5">
<h5 id="irfs">IRFs<a class="anchor" aria-label="anchor" href="#irfs"></a>
</h5>
<p>IRFs give the responses of each variable in <span class="math inline">\(y_t\)</span> for any horizon <span class="math inline">\(i\)</span> to a one-time impulse at time <span class="math inline">\(t\)</span> to each structural shock, <span class="math inline">\(w_t\)</span>, <span class="math display">\[
\Theta_i \equiv \frac{\partial y_{t+i}}{\partial w_t} \hspace{1cm} i =
0, 1, 2, ..., H
\]</span></p>
<p>The IRF for the response of variable <span class="math inline">\(k\)</span> to an impulse for structural shock
<span class="math inline">\(j\)</span> at horizon <span class="math inline">\(i\)</span> is denoted, <span class="math display">\[
\theta_{kj,i} \equiv \frac{\partial y_{k, t+i}}{\partial w_{jt}}
\]</span></p>
<p>Let the impulse responses to the reduced form residuals be similarily
denoted as, <span class="math display">\[
\Phi_i \equiv \frac{\partial y_{t+i}}{\partial u_t} \hspace{1cm} i = 0,
1, 2, ..., H
\\
\phi_{kj,i} \equiv \frac{\partial y_{k, t+i}}{\partial u_{jt}}
\]</span></p>
<p>And we can map between the two using the <span class="math inline">\(B_0\)</span> impact matrix, <span class="math display">\[
\Theta_i = \Phi_i B_0^{-1}
\\
\theta_{kj,i} = [\Phi_i B_0^{-1}]_{kj}
\]</span></p>
<p>Letting <span class="math inline">\(\Phi_{k*,i}\)</span> denote the
<span class="math inline">\(k\)</span>th row of <span class="math inline">\(\Phi_i\)</span> and <span class="math inline">\(B_{0,*j}^{-1}\)</span> denote the <span class="math inline">\(j\)</span>th column of <span class="math inline">\(B_0^{-1}\)</span>, then</p>
<p><span class="math display">\[
\theta_{kj,i} = \Phi_{k*,i} B_{0,*j}^{-1}
\]</span></p>
</div>
<div class="section level5">
<h5 id="forecast-errors">Forecast Errors<a class="anchor" aria-label="anchor" href="#forecast-errors"></a>
</h5>
<p>Let <span class="math inline">\(F_{t+h}\)</span> denote <span class="math inline">\(h\)</span>-step ahead forecast errors, <span class="math display">\[
F_{t+h} \equiv y_{t+h} - y_{t+h|t}
\]</span></p>
<p>Which, for a VAR process, can be denoted in terms of the redcued form
IRFs, <span class="math inline">\(\Phi_i\)</span>, <span class="math display">\[
F_{t+h} = \sum_{i=0}^{h-1} \Phi_i u_{t+h-i} = \sum_{i=0}^{h-1} \Phi_i
B_0^{-1} w_{t+h-i}
\]</span></p>
</div>
<div class="section level5">
<h5 id="forecast-error-variance-fev">Forecast Error Variance (FEV)<a class="anchor" aria-label="anchor" href="#forecast-error-variance-fev"></a>
</h5>
<p>The FEV, also known as the predicted mean squared error, is then
calculated as <span class="math display">\[
FEV_h \equiv E[F_{t+h}F_{t+h}^\prime]
\\
= \sum_{i=0}^{h-1} \Phi_i \Sigma_u \Phi_i^\prime
= \sum_{i=0}^{h-1} \Phi_i B_0^{-1} B_0^{-1^\prime} \Phi_i^\prime
= \sum_{i=0}^{h-1} [\Phi_i B_0^{-1}] [\Phi_i B_0^{-1}]^\prime
\]</span></p>
<p>The FEV for impulse <span class="math inline">\(j\)</span>
contribution to variable <span class="math inline">\(k\)</span> is then
denoted as, <span class="math display">\[
FEV_{kj,h} =  \sum_{i=0}^{h-1}  [\Phi_i B_0^{-1}]_{jk} [\Phi_i
B_0^{-1}]_{jk}^\prime
\\
= \sum_{i=0}^{h-1} \Phi_{k*,i} B_{0,*j}^{-1} [\Phi_{k*,i}
B_{0,*j}^{-1}]^\prime
\\
= \sum_{i=0}^{h-1} \Phi_{k*,i} B_{0,*j}^{-1} B_{0,*j}^{-1\prime}
\Phi_{k*,i}^\prime
\]</span></p>
<p>Since <span class="math inline">\(\Phi_{k*,i} B_{0,*j}^{-1}\)</span>
is a single number (not a matrix), we can rearrange to <span class="math display">\[
= \sum_{i=0}^{h-1} B_{0,*j}^{-1\prime} \Phi_{k*,i}^\prime \Phi_{k*,i}
B_{0,*j}^{-1}
\\
= B_{0,*j}^{-1\prime} \sum_{i=0}^{h-1}\left[\Phi_{k*,i}^\prime
\Phi_{k*,i}\right] B_{0,*j}^{-1}
\]</span></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="max-share-identification-method---time-domain">Max Share Identification Method - Time Domain<a class="anchor" aria-label="anchor" href="#max-share-identification-method---time-domain"></a>
</h3>
<p>Pick a structural shock <span class="math inline">\(j\)</span> by
choosing the weights for <span class="math inline">\(B_{0,*j}^{-1}\)</span> that maximize the forecast
error variance for the horizon in <span class="math inline">\([h^-,
h^+]\)</span></p>
<p>Solve the maximization problem: <span class="math display">\[
\max_{B_{0,*j}^{-1}} \sum_{h^-}^{h^+} \text{FEV}_{kj,h}
\]</span></p>
<p>This is equivalent to solving <span class="math display">\[
\max_{B_{0,*j}^{-1}} B_{0,*j}^{-1\prime} \sum_{h^-}^{h^+}
\sum_{i=0}^{h-1}\left[\Phi_{k*,i}^\prime \Phi_{k*,i}\right]
B_{0,*j}^{-1}
\]</span></p>
<p>Which is maximized when <span class="math inline">\(B_{0,*j}^{-1}\)</span> is the eigenvector
associated with the largest eigenvalue of the matrix <span class="math inline">\(\sum_{h^-}^{h^+}
\sum_{i=0}^{h-1}\left[\Phi_{k*,i}^\prime
\Phi_{k*,i}\right]\)</span>.</p>
<p><strong>There’s a piece missing here, which is that <span class="math inline">\(B_{0,*j}^{-1}B_{0,*j}^{-1}\)</span> can be
decomposed into a Choleskey matrix and rotation matrix Q, then the
maximization problem becomes picking a column of Q.</strong></p>
</div>
<div class="section level3">
<h3 id="max-share-identification-method---frequency-domain">Max Share Identification Method - Frequency Domain<a class="anchor" aria-label="anchor" href="#max-share-identification-method---frequency-domain"></a>
</h3>
<p>Pick a structural shock <span class="math inline">\(j\)</span> by
choosing the weights for <span class="math inline">\(B_{0,*j}^{-1}\)</span> that maximize the forecast
error variance for the frequencies in <span class="math inline">\([\omega^-, \omega^+]\)</span></p>
<p>Solve the maximization problem: <span class="math display">\[
\max_{B_{0,*j}^{-1}} \int_{\omega^-}^{\omega^+} \text{FEV}_{kj,\omega}
d\omega
\]</span></p>
<p>This is equivalent to solving <span class="math display">\[
\max_{B_{0,*j}^{-1}} B_{0,*j}^{-1\prime} \int_{\omega^-}^{\omega^+}
\Phi_{k*,\omega}^\prime \Phi_{k*,\omega} \ d\omega \ B_{0,*j}^{-1}
\]</span></p>
<p>where <span class="math inline">\(\Phi_{k*,\omega}\)</span> is the
impulse response function for a specific frequency <span class="math inline">\(\omega\)</span>. The next sections show how to
calculate this value.</p>
<div class="section level4">
<h4 id="solving-for-irf-in-frequency-space">Solving for IRF in frequency space<a class="anchor" aria-label="anchor" href="#solving-for-irf-in-frequency-space"></a>
</h4>
<p>Note: One approximate solution is to calculate the time domain IRF
out to long horizon (say 1000 periods), then take the fourier
transformation, keep only the frequencies you want, square the
contributions, and maximize the real value portion.</p>
<div class="section level5">
<h5 id="representing-varp-as-a-var1">Representing VAR(p) as a VAR(1)<a class="anchor" aria-label="anchor" href="#representing-varp-as-a-var1"></a>
</h5>
<p>First it’s easiest to work with the VAR(1) process instead of the
VAR(p) <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;see page 25 of Killian and Lutkepohl&lt;/p&gt;"><sup>2</sup></a></p>
<div class="incremental">
<p><span class="math display">\[
Y_t = \upsilon + A Y_{t-1} + U_t
\]</span></p>
</div>
</div>
<div class="section level5">
<h5 id="mainfty-representation">MA(<span class="math inline">\(\infty\)</span>) Representation<a class="anchor" aria-label="anchor" href="#mainfty-representation"></a>
</h5>
<p>Next, represent as a moving average. <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;see page 26 of Killian and Lutkepohl&lt;/p&gt;"><sup>3</sup></a></p>
<div class="incremental">
<p><span class="math display">\[
y_t = C(L)^{-1} \upsilon + C(L)^{-1} u_t
\]</span></p>
<p>where <span class="math inline">\(C(L)^{-1} \equiv
\sum_{i=0}^{\infty} \phi_i L^i\)</span></p>
</div>
</div>
<div class="section level5">
<h5 id="calculating-the-spectrum-for-an-mainfty">Calculating the spectrum for an MA(<span class="math inline">\(\infty\)</span>)<a class="anchor" aria-label="anchor" href="#calculating-the-spectrum-for-an-mainfty"></a>
</h5>
<p>Now, we can calculate the spectrum using <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;See Hamilton, page 152&lt;/p&gt;"><sup>4</sup></a></p>
<div class="incremental">
<p><span class="math display">\[
s_Y(\omega) = \frac{1}{2\pi} \sigma^2 C(e^{-i\omega})C(e^{-i\omega})
\]</span></p>
<p>The key here is that we end up getting to, <span class="math display">\[
C(e^{-i\omega}) = (I - A_1 e^{-i\omega})^{-1}
\]</span></p>
<p>which is essentially solving out for the entire path of IRFs by
inverting, and making the Fourier transformation at the same time.</p>
</div>
<div class="incremental">
<hr>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<p>Hamilton, James D. <em>Time Series Analsysis</em>. Chapter 6:
Spectral Analysis. Pg 152 - 172. In particular, page 154 for deriving
the population spectrum for a MA(infinity) process.</p>
<p>Kilian, Lutz and Lutekepohl Helmut. <em>Structural Vector
Autoregressive Analysis</em>. (2017). In particular,</p>
<ul>
<li>
<em>Chapter 1: Introduction</em> for SVAR notation.</li>
<li>
<em>Chapter 2: Vector Autoregressive Models</em>. Pg 19 - .
Specifically, page 25 for representing a VAR(p) process as a VAR(1)
process.</li>
</ul>
<p>Angeletos, George-Marios, Fabrice Collard, and Harris Dellas. (2020).
“Businsess Cycle Anatomy”. American Economic Review, 110(10): 3030 -
3070. In particular, pages 3036 - 3037 for derivations.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matthew DeHaven.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
