<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Derivations for Max Share Identification Method • fevdid</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Derivations for Max Share Identification Method">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fevdid</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/derivations.html">Derivations for Max Share Identification Method</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Derivations for Max Share Identification Method</h1>
                        <h4 data-toc-skip class="author">Matthew
DeHaven</h4>
            
            <h4 data-toc-skip class="date">January 16, 2023</h4>
      

      <div class="d-none name"><code>derivations.Rmd</code></div>
    </div>

    
    
<p>Article explaining the mathematics behind the two key
<code>fevdid</code> functions:</p>
<ul>
<li><code><a href="../reference/id_fevdfd.html">id_fevdfd()</a></code></li>
<li><code><a href="../reference/id_fevdtd.html">id_fevdtd()</a></code></li>
</ul>
<div class="section level3">
<h3 id="structural-vector-autoregression-svar">Structural Vector Autoregression (SVAR)<a class="anchor" aria-label="anchor" href="#structural-vector-autoregression-svar"></a>
</h3>
<p>A SVAR(p) model with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
lags, for a vector of variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>t</mi></msub><annotation encoding="application/x-tex">y_t</annotation></semantics></math>,
assumes the data generating process is accurately represented as, <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Notation and setup follows Chapter 1: Introduction from
Kilian and Lutkepohl (2017)&lt;/p&gt;"><sup>1</sup></a></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mn>0</mn></msub><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><msub><mi>B</mi><mn>1</mn></msub><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>+</mo><msub><mi>B</mi><mi>p</mi></msub><msub><mi>y</mi><mrow><mi>t</mi><mo>−</mo><mi>p</mi></mrow></msub><mo>+</mo><msub><mi>w</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">
B_0 y_t = B_1 y_{t-1} + ... + B_p y_{t-p} + w_t
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>t</mi></msub><annotation encoding="application/x-tex">w_t</annotation></semantics></math>
are mean zero structural shocks, with a serially uncorrelated diagonal
covariance matrix of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Σ</mi><mi>w</mi></msub><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>w</mi><mi>t</mi></msub><msub><mi>w</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\Sigma_w = E[w_t w_t]</annotation></semantics></math>,</p>
<p>and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mi>i</mi></msub><annotation encoding="application/x-tex">B_i</annotation></semantics></math>
are matrices of coefficients.</p>
<p>Empirically, however, only the following
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>i</mi></msub><annotation encoding="application/x-tex">A_i</annotation></semantics></math>
matrices of coefficients and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mi>t</mi></msub><annotation encoding="application/x-tex">v_t</annotation></semantics></math>
vector of reduced form residuals are observed,</p>
<p><span class="math display">$$
y_t = \underbrace{B_0^{-1}B_1}_{A_1} y_{t-1} + ... +
\underbrace{B_0^{-1}B_p}_{A_p} y_{t-p} + \underbrace{B_0^{-1} w_t}_{u_t}
\\
y_t = A_1 y_{t-1} + ... + A_p y_{t-p} + u_t
$$</span></p>
<div class="section level5">
<h5 id="identification-problem">Identification Problem<a class="anchor" aria-label="anchor" href="#identification-problem"></a>
</h5>
<p>We observe reduced form residuals,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>v</mi><mi>t</mi></msub><annotation encoding="application/x-tex">v_t</annotation></semantics></math>,
but want the structural shocks,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>t</mi></msub><annotation encoding="application/x-tex">w_t</annotation></semantics></math>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>t</mi></msub><mo>=</mo><msubsup><mi>B</mi><mn>0</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>w</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">
u_t = B_0^{-1} w_t
</annotation></semantics></math></p>
<p>At this point, WLOG, assume that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Σ</mi><mi>w</mi></msub><mo>=</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">\Sigma_w = I</annotation></semantics></math>.</p>
<p>This implies that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Σ</mi><mi>u</mi></msub><mo>=</mo><msubsup><mi>B</mi><mn>0</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msubsup><mi>B</mi><mn>0</mn><mrow><mo>−</mo><msup><mn>1</mn><mi>′</mi></msup></mrow></msubsup></mrow><annotation encoding="application/x-tex">\Sigma_u = B_0^{-1} B_0^{-1^\prime}</annotation></semantics></math>.</p>
<p>In order to identify the structural shocks, we simply need to know
the structural impact matrix,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mn>0</mn></msub><annotation encoding="application/x-tex">B_0</annotation></semantics></math>,
or equivalently, the inverse
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>B</mi><mn>0</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">B_0^{-1}</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="impulse-response-functions-irf-and-forecast-errors">Impulse Response Functions (IRF) and Forecast Errors<a class="anchor" aria-label="anchor" href="#impulse-response-functions-irf-and-forecast-errors"></a>
</h4>
<p>It will be useful for the max share method to show the impulse
response and forecast error definitions</p>
<div class="section level5">
<h5 id="irfs">IRFs<a class="anchor" aria-label="anchor" href="#irfs"></a>
</h5>
<p>IRFs give the responses of each variable in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>t</mi></msub><annotation encoding="application/x-tex">y_t</annotation></semantics></math>
for any horizon
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
to a one-time impulse at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
to each structural shock,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>t</mi></msub><annotation encoding="application/x-tex">w_t</annotation></semantics></math>,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Θ</mi><mi>i</mi></msub><mo>≡</mo><mfrac><mrow><mi>∂</mi><msub><mi>y</mi><mrow><mi>t</mi><mo>+</mo><mi>i</mi></mrow></msub></mrow><mrow><mi>∂</mi><msub><mi>w</mi><mi>t</mi></msub></mrow></mfrac><mspace width="2.381em"></mspace><mi>i</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>H</mi></mrow><annotation encoding="application/x-tex">
\Theta_i \equiv \frac{\partial y_{t+i}}{\partial w_t} \hspace{1cm} i = 0, 1, 2, ..., H
</annotation></semantics></math></p>
<p>The IRF for the response of variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
to an impulse for structural shock
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
at horizon
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is denoted,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>k</mi><mi>j</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>≡</mo><mfrac><mrow><mi>∂</mi><msub><mi>y</mi><mrow><mi>k</mi><mo>,</mo><mi>t</mi><mo>+</mo><mi>i</mi></mrow></msub></mrow><mrow><mi>∂</mi><msub><mi>w</mi><mrow><mi>j</mi><mi>t</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
\theta_{kj,i} \equiv \frac{\partial y_{k, t+i}}{\partial w_{jt}}
</annotation></semantics></math></p>
<p>Let the impulse responses to the reduced form residuals be similarily
denoted as, <span class="math display">$$
\Phi_i \equiv \frac{\partial y_{t+i}}{\partial u_t} \hspace{1cm} i = 0,
1, 2, ..., H
\\
\phi_{kj,i} \equiv \frac{\partial y_{k, t+i}}{\partial u_{jt}}
$$</span></p>
<p>And we can map between the two using the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>B</mi><mn>0</mn></msub><annotation encoding="application/x-tex">B_0</annotation></semantics></math>
impact matrix, <span class="math display">$$
\Theta_i = \Phi_i B_0^{-1}
\\
\theta_{kj,i} = [\Phi_i B_0^{-1}]_{kj}
$$</span></p>
<p>Letting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Φ</mi><mrow><mi>k</mi><mo>*</mo><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\Phi_{k*,i}</annotation></semantics></math>
denote the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>th
row of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Φ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\Phi_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">B_{0,*j}^{-1}</annotation></semantics></math>
denote the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>th
column of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>B</mi><mn>0</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">B_0^{-1}</annotation></semantics></math>,
then</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>k</mi><mi>j</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>Φ</mi><mrow><mi>k</mi><mo>*</mo><mo>,</mo><mi>i</mi></mrow></msub><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">
\theta_{kj,i} = \Phi_{k*,i} B_{0,*j}^{-1}
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="forecast-errors">Forecast Errors<a class="anchor" aria-label="anchor" href="#forecast-errors"></a>
</h5>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mrow><mi>t</mi><mo>+</mo><mi>h</mi></mrow></msub><annotation encoding="application/x-tex">F_{t+h}</annotation></semantics></math>
denote
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>-step
ahead forecast errors,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>t</mi><mo>+</mo><mi>h</mi></mrow></msub><mo>≡</mo><msub><mi>y</mi><mrow><mi>t</mi><mo>+</mo><mi>h</mi></mrow></msub><mo>−</mo><msub><mi>y</mi><mrow><mi>t</mi><mo>+</mo><mi>h</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
F_{t+h} \equiv y_{t+h} - y_{t+h|t}
</annotation></semantics></math></p>
<p>Which, for a VAR process, can be denoted in terms of the redcued form
IRFs,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Φ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\Phi_i</annotation></semantics></math>,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>t</mi><mo>+</mo><mi>h</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>Φ</mi><mi>i</mi></msub><msub><mi>u</mi><mrow><mi>t</mi><mo>+</mo><mi>h</mi><mo>−</mo><mi>i</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>Φ</mi><mi>i</mi></msub><msubsup><mi>B</mi><mn>0</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msub><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mi>h</mi><mo>−</mo><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
F_{t+h} = \sum_{i=0}^{h-1} \Phi_i u_{t+h-i} = \sum_{i=0}^{h-1} \Phi_i B_0^{-1} w_{t+h-i}
</annotation></semantics></math></p>
</div>
<div class="section level5">
<h5 id="forecast-error-variance-fev">Forecast Error Variance (FEV)<a class="anchor" aria-label="anchor" href="#forecast-error-variance-fev"></a>
</h5>
<p>The FEV, also known as the predicted mean squared error, is then
calculated as <span class="math display">$$
FEV_h \equiv E[F_{t+h}F_{t+h}^\prime]
\\
= \sum_{i=0}^{h-1} \Phi_i \Sigma_u \Phi_i^\prime
= \sum_{i=0}^{h-1} \Phi_i B_0^{-1} B_0^{-1^\prime} \Phi_i^\prime
= \sum_{i=0}^{h-1} [\Phi_i B_0^{-1}] [\Phi_i B_0^{-1}]^\prime
$$</span></p>
<p>The FEV for impulse
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
contribution to variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is then denoted as, <span class="math display">$$
FEV_{kj,h} =  \sum_{i=0}^{h-1}  [\Phi_i B_0^{-1}]_{jk} [\Phi_i
B_0^{-1}]_{jk}^\prime
\\
= \sum_{i=0}^{h-1} \Phi_{k*,i} B_{0,*j}^{-1} [\Phi_{k*,i}
B_{0,*j}^{-1}]^\prime
\\
= \sum_{i=0}^{h-1} \Phi_{k*,i} B_{0,*j}^{-1} B_{0,*j}^{-1\prime}
\Phi_{k*,i}^\prime
$$</span></p>
<p>Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Φ</mi><mrow><mi>k</mi><mo>*</mo><mo>,</mo><mi>i</mi></mrow></msub><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\Phi_{k*,i} B_{0,*j}^{-1}</annotation></semantics></math>
is a single number (not a matrix), we can rearrange to <span class="math display">$$
= \sum_{i=0}^{h-1} B_{0,*j}^{-1\prime} \Phi_{k*,i}^\prime \Phi_{k*,i}
B_{0,*j}^{-1}
\\
= B_{0,*j}^{-1\prime} \sum_{i=0}^{h-1}\left[\Phi_{k*,i}^\prime
\Phi_{k*,i}\right] B_{0,*j}^{-1}
$$</span></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="max-share-identification-method---time-domain">Max Share Identification Method - Time Domain<a class="anchor" aria-label="anchor" href="#max-share-identification-method---time-domain"></a>
</h3>
<p>Pick a structural shock
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
by choosing the weights for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">B_{0,*j}^{-1}</annotation></semantics></math>
that maximize the forecast error variance for the horizon in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>h</mi><mo>−</mo></msup><mo>,</mo><msup><mi>h</mi><mo>+</mo></msup><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[h^-, h^+]</annotation></semantics></math></p>
<p>Solve the maximization problem:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>max</mo><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></munder><munderover><mo>∑</mo><msup><mi>h</mi><mo>−</mo></msup><msup><mi>h</mi><mo>+</mo></msup></munderover><msub><mtext mathvariant="normal">FEV</mtext><mrow><mi>k</mi><mi>j</mi><mo>,</mo><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">
\max_{B_{0,*j}^{-1}} \sum_{h^-}^{h^+} \text{FEV}_{kj,h}
</annotation></semantics></math></p>
<p>This is equivalent to solving
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>max</mo><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></munder><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn><mi>′</mi></mrow></msubsup><munderover><mo>∑</mo><msup><mi>h</mi><mo>−</mo></msup><msup><mi>h</mi><mo>+</mo></msup></munderover><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><mi>Φ</mi><mrow><mi>k</mi><mo>*</mo><mo>,</mo><mi>i</mi></mrow><mi>′</mi></msubsup><msub><mi>Φ</mi><mrow><mi>k</mi><mo>*</mo><mo>,</mo><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">
\max_{B_{0,*j}^{-1}} B_{0,*j}^{-1\prime} \sum_{h^-}^{h^+} \sum_{i=0}^{h-1}\left[\Phi_{k*,i}^\prime \Phi_{k*,i}\right] B_{0,*j}^{-1}
</annotation></semantics></math></p>
<p>Which is maximized when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">B_{0,*j}^{-1}</annotation></semantics></math>
is the eigenvector associated with the largest eigenvalue of the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><msup><mi>h</mi><mo>−</mo></msup><msup><mi>h</mi><mo>+</mo></msup></msubsup><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>h</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">[</mo><msubsup><mi>Φ</mi><mrow><mi>k</mi><mo>*</mo><mo>,</mo><mi>i</mi></mrow><mi>′</mi></msubsup><msub><mi>Φ</mi><mrow><mi>k</mi><mo>*</mo><mo>,</mo><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\sum_{h^-}^{h^+} \sum_{i=0}^{h-1}\left[\Phi_{k*,i}^\prime \Phi_{k*,i}\right]</annotation></semantics></math>.</p>
<p><strong>There’s a piece missing here, which is that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">B_{0,*j}^{-1}B_{0,*j}^{-1}</annotation></semantics></math>
can be decomposed into a Choleskey matrix and rotation matrix Q, then
the maximization problem becomes picking a column of Q.</strong></p>
</div>
<div class="section level3">
<h3 id="max-share-identification-method---frequency-domain">Max Share Identification Method - Frequency Domain<a class="anchor" aria-label="anchor" href="#max-share-identification-method---frequency-domain"></a>
</h3>
<p>Pick a structural shock
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
by choosing the weights for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">B_{0,*j}^{-1}</annotation></semantics></math>
that maximize the forecast error variance for the frequencies in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>ω</mi><mo>−</mo></msup><mo>,</mo><msup><mi>ω</mi><mo>+</mo></msup><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[\omega^-, \omega^+]</annotation></semantics></math></p>
<p>Solve the maximization problem:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>max</mo><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></munder><msubsup><mo>∫</mo><msup><mi>ω</mi><mo>−</mo></msup><msup><mi>ω</mi><mo>+</mo></msup></msubsup><msub><mtext mathvariant="normal">FEV</mtext><mrow><mi>k</mi><mi>j</mi><mo>,</mo><mi>ω</mi></mrow></msub><mi>d</mi><mi>ω</mi></mrow><annotation encoding="application/x-tex">
\max_{B_{0,*j}^{-1}} \int_{\omega^-}^{\omega^+} \text{FEV}_{kj,\omega} d\omega
</annotation></semantics></math></p>
<p>This is equivalent to solving
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>max</mo><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></munder><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn><mi>′</mi></mrow></msubsup><msubsup><mo>∫</mo><msup><mi>ω</mi><mo>−</mo></msup><msup><mi>ω</mi><mo>+</mo></msup></msubsup><msubsup><mi>Φ</mi><mrow><mi>k</mi><mo>*</mo><mo>,</mo><mi>ω</mi></mrow><mi>′</mi></msubsup><msub><mi>Φ</mi><mrow><mi>k</mi><mo>*</mo><mo>,</mo><mi>ω</mi></mrow></msub><mspace width="0.222em"></mspace><mi>d</mi><mi>ω</mi><mspace width="0.222em"></mspace><msubsup><mi>B</mi><mrow><mn>0</mn><mo>,</mo><mo>*</mo><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">
\max_{B_{0,*j}^{-1}} B_{0,*j}^{-1\prime} \int_{\omega^-}^{\omega^+} \Phi_{k*,\omega}^\prime \Phi_{k*,\omega} \ d\omega \ B_{0,*j}^{-1}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Φ</mi><mrow><mi>k</mi><mo>*</mo><mo>,</mo><mi>ω</mi></mrow></msub><annotation encoding="application/x-tex">\Phi_{k*,\omega}</annotation></semantics></math>
is the impulse response function for a specific frequency
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ω</mi><annotation encoding="application/x-tex">\omega</annotation></semantics></math>.
The next sections show how to calculate this value.</p>
<div class="section level4">
<h4 id="solving-for-irf-in-frequency-space">Solving for IRF in frequency space<a class="anchor" aria-label="anchor" href="#solving-for-irf-in-frequency-space"></a>
</h4>
<p>Note: One approximate solution is to calculate the time domain IRF
out to long horizon (say 1000 periods), then take the fourier
transformation, keep only the frequencies you want, square the
contributions, and maximize the real value portion.</p>
<div class="section level5">
<h5 id="representing-varp-as-a-var1">Representing VAR(p) as a VAR(1)<a class="anchor" aria-label="anchor" href="#representing-varp-as-a-var1"></a>
</h5>
<p>First it’s easiest to work with the VAR(1) process instead of the
VAR(p) <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;see page 25 of Killian and Lutkepohl&lt;/p&gt;"><sup>2</sup></a></p>
<p>. . .</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>t</mi></msub><mo>=</mo><mi>υ</mi><mo>+</mo><mi>A</mi><msub><mi>Y</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>U</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">
Y_t = \upsilon + A Y_{t-1} + U_t
</annotation></semantics></math></p>
<p>. . .</p>
</div>
<div class="section level5">
<h5 id="mainfty-representation">MA(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>∞</mi><annotation encoding="application/x-tex">\infty</annotation></semantics></math>)
Representation<a class="anchor" aria-label="anchor" href="#mainfty-representation"></a>
</h5>
<p>Next, represent as a moving average. <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;see page 26 of Killian and Lutkepohl&lt;/p&gt;"><sup>3</sup></a></p>
<p>. . .</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><mi>C</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>L</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>υ</mi><mo>+</mo><mi>C</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>L</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>u</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">
y_t = C(L)^{-1} \upsilon + C(L)^{-1} u_t
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>L</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>≡</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>∞</mi></msubsup><msub><mi>ϕ</mi><mi>i</mi></msub><msup><mi>L</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">C(L)^{-1} \equiv \sum_{i=0}^{\infty} \phi_i L^i</annotation></semantics></math></p>
<p>. . .</p>
</div>
<div class="section level5">
<h5 id="calculating-the-spectrum-for-an-mainfty">Calculating the spectrum for an
MA(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>∞</mi><annotation encoding="application/x-tex">\infty</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#calculating-the-spectrum-for-an-mainfty"></a>
</h5>
<p>Now, we can calculate the spectrum using <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;See Hamilton, page 152&lt;/p&gt;"><sup>4</sup></a></p>
<p>. . .</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>Y</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ω</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><msup><mi>σ</mi><mn>2</mn></msup><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mi>ω</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mi>ω</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
s_Y(\omega) = \frac{1}{2\pi} \sigma^2 C(e^{-i\omega})C(e^{-i\omega})
</annotation></semantics></math></p>
<p>The key here is that we end up getting to,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mi>ω</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo>−</mo><msub><mi>A</mi><mn>1</mn></msub><msup><mi>e</mi><mrow><mo>−</mo><mi>i</mi><mi>ω</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">
C(e^{-i\omega}) = (I - A_1 e^{-i\omega})^{-1}
</annotation></semantics></math></p>
<p>which is essentially solving out for the entire path of IRFs by
inverting, and making the Fourier transformation at the same time.</p>
<p>. . .</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<p>Hamilton, James D. <em>Time Series Analsysis</em>. Chapter 6:
Spectral Analysis. Pg 152 - 172. In particular, page 154 for deriving
the population spectrum for a MA(infinity) process.</p>
<p>Kilian, Lutz and Lutekepohl Helmut. <em>Structural Vector
Autoregressive Analysis</em>. (2017). In particular,</p>
<ul>
<li>
<em>Chapter 1: Introduction</em> for SVAR notation.</li>
<li>
<em>Chapter 2: Vector Autoregressive Models</em>. Pg 19 - .
Specifically, page 25 for representing a VAR(p) process as a VAR(1)
process.</li>
</ul>
<p>Angeletos, George-Marios, Fabrice Collard, and Harris Dellas. (2020).
“Businsess Cycle Anatomy”. American Economic Review, 110(10): 3030 -
3070. In particular, pages 3036 - 3037 for derivations.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew DeHaven.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
